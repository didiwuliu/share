<!DOCTYPE html>
<!--
    Google HTML5 slide template
    
    Authors: Luke Mahé (code)
             Marcin Wichary (code and design)
             
             Dominic Mazzoni (browser compatibility)
             Charles Chen (ChromeVox support)
    
    URL: http://code.google.com/p/html5slides/
    -->
<html>
<head>
    <title>Presentation</title>
    <meta charset='utf-8'>
    <script src='http://localhost/github/share/node/slides.js'></script>
</head>
<style>
    /* Your individual styles here, or just use inline styles if that’s
    what you want. */
</style>
<body style='display: none'>
<section class='slides layout-regular template-yongche'>
<!-- Your slides (<article>s) go here. Delete or comment out the
    slides below. -->
<article class='biglogo'>
</article>
<article>
    <h1>
        使用nodejs构建web网站
    </h1>
    <p>
        张春生
        <br>
        2014年5月3日
    </p>
</article>
<article>
    <h3>
        概述
    </h3>
    <ul class="build">
        <li>nodejs基础</li>
        <li>构建web网站</li>
        <li>events模块</li>
        <li>http模块</li>
        <li>websocket</li>
    </ul>
    </p>
</article>
<article>
    <h3>
        nodejs基础
    </h3>
    <ul>
        <li>
            node安装
        </li>
        <li>
            hello world
            <p>
                <section>
                    <pre>
  function helloWorld() {
    console.log("hello world!");
  }
  helloWorld();
</pre>
                </section>
            </p>
        </li>
        <li>CommonJS规范</li>
        <li>NPM包管理</li>
        <li>工程目录</li>
    </ul>
</article>

<article class="smaller">
    <h3>
        CommonJS规范
    </h3>
    <p>Node.js采用CommnJS规范</p>
    <p>
        根据CommonJS规范，一个单独的文件就是一个模块。加载模块使用require方法，该方法读取一个文件并执行，最后返回文件内部的exports对象。下面就是一个简单的模块文件example.js。
        <pre>
exports.message = "hello world!";

exports.say = function () {
  console.log(message);
}
        </pre>
    </p>
    <p>
        使用require方法，加载example.js。<br/>
        var example = require('./example.js');<br/>
        这时，变量example就对应模块中的exports对象，于是就可以通过这个变量，使用模块提供的各个方法。
        {
        message: "hello world!",
        say: [Function]
        }
    </p>
</article>

<article class="smaller">
    <h3>
        CommonJS规范
    </h3>
    <p>
        require方法默认读取js文件，所以可以省略js后缀名。
        <pre>var example = require('./example');</pre>
    </p>
    <p>
        js文件名前面需要加上路径，可以是相对路径（相对于使用require方法的文件），也可以是绝对路径。如果省略路径，node.js会认为，你要加载一个核心模块，或者已经安装在本地 node_modules 目录中的模块。如果加载的是一个目录，node.js会首先寻找该目录中的 package.json 文件，加载该文件 main 属性提到的模块，否则就寻找该目录下的 index.js 文件。
    </p>
    <p>
        有时，不需要exports返回一个对象，只需要它返回一个函数。这时，就要写成module.exports。

        <pre>
module.exports = function () {
    console.log("hello world")
}
</pre>
    </p>
</article>

<article class="smaller">
    <h3>
        NPM包管理
    </h3>
    <p>
        NPM是随同NodeJS一起安装的包管理工具，能解决NodeJS代码部署上的很多问题，常见的使用场景有以下几种：
    </p>
    <ul>
        <li>允许用户从NPM服务器下载别人编写的第三方包到本地使用。</li>
        <li>允许用户从NPM服务器下载并安装别人编写的命令行程序到本地使用。</li>
        <li>允许用户将自己编写的包或命令行程序上传到NPM服务器供别人使用。</li>
    </ul>
    <p>
        可以看到，NPM建立了一个NodeJS生态圈，NodeJS开发者和用户可以在里边互通有无。
    </p>
    <h4>模块的安装</h4>
    <p>
        每个模块可以“全局安装”，也可以“本地安装”。两者的差异是模块的安装位置，以及调用方法。
        “全局安装”指的是将一个模块直接下载到Node的安装目录中，各个项目都可以调用。“本地安装”指的是将一个模块下载到当前目录的node_modules子目录，然后只有在当前目录和它的子目录之中，才能调用这个模块。一般来说，全局安装只适用于工具模块，比如npm和grunt。
        默认情况下，npm install 命令是“本地安装”某个模块。
    </p>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        <pre>npm install [package name]</pre>
    </p>
    <p>
        npm也支持直接输入github地址。
    </p>
    <p>
        <pre>npm install git://github.com/package/path.git
npm install git://github.com/package/path.git#0.1.0</pre>
    </p>
    <p>
        使用安装命令以后，模块文件将下载到当前目录的 node_modules 子目录。
        使用global参数，可以“全局安装”某个模块。
        <pre>sudo npm install -global [package name]</pre>
    </p>
    <p>
        global参数可以被简化成g参数。
        <pre>sudo npm install -g [package name]</pre>
    </p>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        install命令总是安装模块的最新版本，如果要安装模块的特定版本，可以在模块名后面加上@和版本号。
        <pre>npm install package_name@version</pre>
    </p>
    <p>
        一旦安装了某个模块，就可以在代码中用require命令调用这个模块。
        <pre>var backbone = require('backbone')
console.log(backbone.VERSION)</pre>
    </p>
    <h4>模块的升级和删除</h4>
    <p>
        npm update 命令可以升级本地安装的模块。
        <pre>npm update [package name]</pre>
    </p>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        加上global参数，可以升级全局安装的模块。
    <pre>npm update -global [package name]</pre>
    </p>
    <p>
        npm uninstall 命令，删除本地安装的模块。
    <pre>npm uninstall [package name]</pre>
    </p>
    <p>
        加上global参数，可以删除全局安装的模块。
    <pre>sudo npm uninstall [package name] -global</pre>
    </p>

    <h4>列出当前项目的模块</h4>
    <p>
        npm list命令，默认列出当前目录安装的所有模块。如果使用global参数，就是列出全局安装的模块。
    </p>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        <pre>npm list
npm -global list</pre>
    </p>

    <h4>模块搜索</h4>
    <p>
        向服务器端搜索某个模块，使用search命令（可使用正则搜索）。
        <pre>npm search [搜索词]</pre>
    </p>

    <h4>模块的发布</h4>
    <p>
        在发布你的模块之前，需要先设定个人信息。
        <pre>npm set init.author.name "xxx"
npm set init.author.email "xxx@yongche.com"
npm set init.author.url "http://www.yongche.com"</pre>
    </p>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        然后，请npm系统申请用户名。
        <pre>npm adduser</pre>
    </p>
    <p>
        运行上面的命令之后，屏幕上会提示输入用户名，然后是输入Email地址和密码。
        上面所有的这些个人信息，全部保存在~/.npmrc文件之中。
    </p>
    <p>
        npm模块就是一个遵循CommonJS规范的JavaScript脚本文件。此外，在模块目录中还必须有一个提供自身信息的package.json文件，一般采用npm init命令生成这个文件。
        <pre>npm init</pre>
    </p>
    <p>
        运行上面的命令，会提示回答一系列问题，结束后自动生成package.json文件。
        package.json文件中的main属性，指定模块加载的入口文件，默认是index.js。在index.js文件中，除了模块代码以外，主要使用require命令加载其他模块，使用module.exports变量输出模块接口。
    </p>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        完成代码以后，再加一个README.md文件，用来给出说明文本。
        最后，使用npm publish命令发布。
        <pre>npm publish</pre>
    </p>
    <p>
        package.json详细说明
        <a href="https://www.npmjs.org/doc/json.html" target="_blank">https://www.npmjs.org/doc/json.html</a>
    </p>
    <ul>
        <li>name 包名，在NPM服务器上须要保持唯一</li>
        <li>version 当前版本号</li>
        <li>description 第三方包依赖，需要指定包名和版本号</li>
        <li>keywords</li>
        <li>main 入口模块位置</li>
        <li>bin 命令行程序名和主模块位置</li>
        <li>dependencies</li>
        <li>devDependencies</li>
    </ul>
</article>

<article class="smaller">
    <h3>NPM包管理</h3>
    <p>
        NPM使用语义版本号来管理代码
        语义版本号分为X.Y.Z三位，分别代表主版本号、次版本号和补丁版本号。当代码变更时，版本号按以下原则更新。
    </p>
    <ul>
        <li>+ 如果只是修复bug，需要更新Z位。</li>
        <li>+ 如果是新增了功能，但是向下兼容，需要更新Y位。</li>
        <li>+ 如果有大变动，向下不兼容，需要更新X位。</li>
    </ul>
    <h4>npm命令</h4>
    <p>
        <pre>npm help 查看所有命令
npm help &lt;command&gt; 可查看某条命令的详细帮助
npm install. -g 可先在本地安装当前命令行程序，可用于发布前的本地测试。
npm update &lt;package&gt; 可以把当前目录下node_modules子目录里边的对应模块更新至最新版本。
npm update &lt;package&gt; -g 可以把全局安装的对应命令行程序更新至最新版。
npm cache clear 可以清空NPM本地缓存
npm unpublish &lt;package&gt;@&lt;version&gt; 以撤销发布自己发布过的某个版本代码
npm config list -l 查看配置
npm info &lt;name&gt; 查看模块信息
npm update -global npm 更新npm</pre>
    </p>
</article>

<article class="smaller">
    <h3>
        工程目录
    </h3>
    <p>
        <pre>
- /home/user/workspace/yongche-echo/   # 工程目录
    - bin/                          # 存放命令行相关代码
        node-echo
     + doc/                          # 存放文档
    - lib/                          # 存放API相关代码
        echo.js
    - node_modules/                 # 存放三方包
        + argv/
    + tests/                        # 存放测试用例
    package.json                    # 元数据文件
    README.md                       # 说明文件
        </pre>
    </p>
</article>

<article>
    <h3>
        构建web网站
    </h3>
    <ul>
        <li>Express简介</li>
        <li>MVC设计</li>
        <li>Session管理</li>
        <li>数据库操作</li>
        <li>负载均衡</li>
    </ul>
</article>

<article class="smaller">
    <h3>
        events模块
    </h3>
</article>

<article class="smaller">
    <h3>
        http模块
    </h3>
</article>

<article class='smaller'>
    <h3>
        websocket
    </h3>
    <p>
    </p>
    <p>
    </p>
</article>
<article>
    <h3>
        Slide with bullet points and a longer title, just because we
        can make it longer
    </h3>
    <ul>
        <li>
            Use this template to create your presentation
        </li>
        <li>
            Use the provided color palette, box and arrow graphics, and
            chart styles
        </li>
        <li>
            Instructions are provided to assist you in using this
            presentation template effectively
        </li>
        <li>
            At all times strive to maintain Google's corporate look and feel
        </li>
    </ul>
</article>
<article>
    <h3>
        Slide with bullet points that builds
    </h3>
    <ul class="build">
        <li>
            This is an example of a list
        </li>
        <li>
            The list items fade in
        </li>
        <li>
            Last one!
        </li>
    </ul>
    <div class="build">
        <p>Any element with child nodes can build.</p>
        <p>It doesn't have to be a list.</p>
    </div>
</article>
<article class='smaller'>
    <h3>
        Slide with bullet points (small font)
    </h3>
    <ul>
        <li>
            Use this template to create your presentation
        <li>
            Use the provided color palette, box and arrow graphics, and
            chart styles
        <li>
            Instructions are provided to assist you in using this
            presentation template effectively
        <li>
            At all times strive to maintain Google's corporate look and feel
    </ul>
</article>
<article>
    <h3>
        Slide with a table
    </h3>
    <table>
        <tr>
            <th>
                Name
            <th>
                Occupation
                <tr>
                    <td>
                        Luke Mahé
                    <td>
                        V.P. of Keepin’ It Real
        <tr>
            <td>
                Marcin Wichary
            <td>
                The Michael Bay of Doodles
    </table>
</article>
<article class='smaller'>
    <h3>
        Slide with a table (smaller text)
    </h3>
    <table>
        <tr>
            <th>
                Name
            <th>
                Occupation
                <tr>
                    <td>
                        Luke Mahé
                    <td>
                        V.P. of Keepin’ It Real
        <tr>
            <td>
                Marcin Wichary
            <td>
                The Michael Bay of Doodles
    </table>
</article>
<article>
    <h3>
        Styles
    </h3>
    <ul>
        <li>
            <span class='red'>class="red"</span>
        <li>
            <span class='blue'>class="blue"</span>
        <li>
            <span class='green'>class="green"</span>
        <li>
            <span class='yellow'>class="yellow"</span>
        <li>
            <span class='black'>class="black"</span>
        <li>
            <span class='white'>class="white"</span>
        <li>
            <b>bold</b> and <i>italic</i>
    </ul>
</article>
<article>
    <h2>
        Segue slide
    </h2>
</article>
<article>
    <h3>
        Slide with an image
    </h3>
    <p>
        <img style='height: 500px' src='images/example-graph.png'>
    </p>
    <div class='source'>
        Source: Sergey Brin
    </div>
</article>
<article>
    <h3>
        Slide with an image (centered)
    </h3>
    <p>
        <img class='centered' style='height: 500px' src='images/example-graph.png'>
    </p>
    <div class='source'>
        Source: Larry Page
    </div>
</article>
<article class='fill'>
    <h3>
        Image filling the slide (with optional header)
    </h3>
    <p>
        <img src='images/example-cat.jpg'>
    </p>
    <div class='source white'>
        Source: Eric Schmidt
    </div>
</article>
<article>
    <h3>
        This slide has some code
    </h3>
    <section>
                    <pre>
&lt;script type='text/javascript'&gt;
  // Say hello world until the user starts questioning
  // the meaningfulness of their existence.
  function helloWorld(world) {
    for (var i = 42; --i &gt;= 0;) {
      alert('Hello ' + String(world));
    }
  }
&lt;/script&gt;
&lt;style&gt;
  p { color: pink }
  b { color: blue }
  u { color: 'umber' }
&lt;/style&gt;
</pre>
    </section>
</article>
<article class='smaller'>
    <h3>
        This slide has some code (small font)
    </h3>
    <section>
                    <pre>
&lt;script type='text/javascript'&gt;
  // Say hello world until the user starts questioning
  // the meaningfulness of their existence.
  function helloWorld(world) {
    for (var i = 42; --i &gt;= 0;) {
      alert('Hello ' + String(world));
    }
  }
&lt;/script&gt;
&lt;style&gt;
  p { color: pink }
  b { color: blue }
  u { color: 'umber' }
&lt;/style&gt;
</pre>
    </section>
</article>
<article>
    <q>
        The best way to predict the future is to invent it.
    </q>
    <div class='author'>
        Alan Kay
    </div>
</article>
<article class='smaller'>
    <q>
        A distributed system is one in which the failure of a computer
        you didn’t even know existed can render your own computer unusable.
    </q>
    <div class='author'>
        Leslie Lamport
    </div>
</article>
<article class='nobackground'>
    <h3>
        A slide with an embed + title
    </h3>
    <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
</article>
<article class='nobackground'>
    <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
</article>
<article class='fill'>
    <h3>
        Full-slide embed with (optional) slide title on top
    </h3>
    <iframe src='http://www.google.com/doodle4google/history.html'></iframe>
</article>
<article>
    <h3>
        Thank you!
    </h3>
    <ul>
        <li>
            <a href='http://www.google.com'>google.com</a>
    </ul>
</article>
</section>
</body>
</html>